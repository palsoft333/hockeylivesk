!function(t){"use strict";var e=function(t,e){this.init("calendario",t,e)};e.INFO={EMAIL:"%email%",FEED:"%feed%",NAME:"FrozenTime!",VERSION:"4.1.0",UNIQUE:"%unique%",USER:"%user%",UPDATEURL:"%url%"},e.DEFAULTS={weeks:["Nedeľa","Pondelok","Utorok","Streda","Štvrtok","Piatok","Sobota"],weekabbrs:["Ne","Po","Ut","St","Št","Pi","So"],months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],monthabbrs:["Jan","Feb","Mar","Apr","Máj","Jún","Júl","Aug","Sep","Okt","Nov","Dec"],displayWeekAbbr:!1,displayMonthAbbr:!1,startIn:1,fillEmpty:!0,zone:"00:00",events:["click","focus","hover"],checkUpdate:!1,weekdays:"PON, UTO, STR, STV, PIA",weekends:"SOB, NED"},e.prototype.init=function(a,o,n){this.INFO=e.INFO,this.type=a,this.$element=t(o),this.options=t.extend({},e.DEFAULTS,this.$element.data(),n),this.today=new Date,this.month=isNaN(this.options.month)||null===this.options.month?this.today.getMonth():this.options.month-1,this.year=isNaN(this.options.year)||null===this.options.year?this.today.getFullYear():this.options.year,this.caldata=this.processCaldata(this.options.caldata),this.curData=[],this.syncData={},this.generateTemplate(),this.initEvents()},e.prototype.sync=function(e){var a=this;return t.post(a.options.feed,{info:a.INFO,caldata:e,domain:document.domain},(function(t){a.syncData=t}),"json"),e},e.prototype.initEvents=function(){this.$element.on(this.options.events.join(".calendario ").trim()+".calendario","div.row > div:not(:empty)",(function(e){t(this).trigger(t.Event("onDay"+e.type.charAt(0).toUpperCase()+e.type.slice(1)),[t(this).data("bz.calendario.dateprop")])}))},e.prototype.propDate=function(){var e=this;this.$element.find("div.row > div").filter(":not(:empty)").each((function(){var a={day:t(this).children("span.fc-date").text(),month:e.month+1,monthname:e.options.displayMonthAbbr?e.options.monthabbrs[e.month]:e.options.months[e.month],year:e.year,weekday:t(this).index()+e.options.startIn,weekdayname:e.options.weeks[6==t(this).index()?0:t(this).index()+e.options.startIn],data:!!e.curData[t(this).children("span.fc-date").text()]&&e.curData[t(this).children("span.fc-date").text()]};t(this).data("bz.calendario.dateprop",a)}))},e.prototype.insertToCaldata=function(t,e,a,o){return o[t]||(o[t]=[]),e.repeat?e.day=[a[1],e.endDate.split("-")[1]]:e.day=[a[1],a[1]],e.repeat?e.month=[a[0],e.endDate.split("-")[0]]:e.month=[a[0],a[0]],e.repeat?e.year=[a[2],e.endDate.split("-")[2]]:e.year=[a[2],a[2]],e.category=e.category?"calendar-"+e.category.split("-").pop():"calendar-default list-group-item list-group-item-action small p-2 text-center",o[t].push(e),o},e.prototype.processCaldata=function(e){var a={},o=this;return t.each(e,(function(e,n){t.each(n,(function(n,r){"INTERVAL"==r.repeat||"EVERYDAY"==r.repeat?r.repeat="MON, TUE, WED, THU, FRI, SAT, SUN":"WEEKDAYS"==r.repeat?r.repeat=o.options.weekdays:"WEEKENDS"==r.repeat&&(r.repeat=o.options.weekends),-1!=t.inArray(r.repeat,[void 0,"YEARLY","MONTHLY"])?a=o.insertToCaldata(parseInt(e.split("-")[1]),r,e.split("-"),a):r.repeat&&t.each(r.repeat.split(","),(function(n,i){a=o.insertToCaldata(i.trim(),t.extend(r,{repeat:"WEEKLY"}),e.split("-"),a)}))}))})),o.sync(a)},e.prototype.toDObj=function(t,e){var a=parseInt(this.options.zone.split(":")[0]),o=parseInt(this.options.zone.charAt(0)+this.options.zone.split(":")[1]),n=parseInt(t.split(":")[0])-a,r=parseInt(t.split(":")[1])-o;return new Date(Date.UTC(this.year,this.month,e,n,r,0,0))},e.prototype.parseDay=function(t,e){this.curData[e]||(this.curData[e]={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[],color:[]}),t.allDay?this.curData[e].allDay.push(!0):this.curData[e].allDay.push(!1),t.allDay?this.curData[e].startTime.push(this.toDObj("00:00",e)):this.curData[e].startTime.push(this.toDObj(t.startTime,e)),t.allDay?this.curData[e].endTime.push(this.toDObj("23:59",e)):this.curData[e].endTime.push(this.toDObj(t.endTime,e)),t.note?this.curData[e].note.push(t.note):this.curData[e].note.push(""),t.content?this.curData[e].content.push(t.content):this.curData[e].content.push(""),t.url?this.curData[e].url.push(t.url):this.curData[e].url.push(""),t.color?this.curData[e].color.push(t.color):this.curData[e].color.push("");var a=t.url?this.curData[e].html.push('<a class="'+t.category+'" href="'+t.url+'">'+t.content+"</a>")-1:this.curData[e].html.push('<span class="'+t.category+'">'+t.content+"</span>")-1;this.curData[e].html[a]+='<time class="fc-allday" datetime="'+this.curData[e].allDay[a]+'"></time>',this.curData[e].html[a]+='<time class="fc-starttime" datetime="'+this.curData[e].startTime[a].toISOString()+'"></time>',this.curData[e].html[a]+='<time class="fc-endtime" datetime="'+this.curData[e].endTime[a].toISOString()+'"></time>',this.curData[e].html[a]+="<note>"+this.curData[e].note[a]+"</note>"},e.prototype.parseDayID=function(t,e){this.curData[e]||(this.curData[e]={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[],color:[]}),t.color?this.curData[e].color.push(t.color):this.curData[e].color.push("")},e.prototype.parseDataToDay=function(e,a){var o=this;return t.each(e,(function(t,e){e&&("YEARLY"==e.repeat||"MONTHLY"==e.repeat||"WEEKLY"==e.repeat?o.year>=e.year[0]&&o.year<=e.year[1]&&("YEARLY"==e.repeat&&o.month+1==e.month[0]&&o.parseDay(e,a),o.year==e.year[0]&&o.month+1>=e.month[0]?("MONTHLY"==e.repeat&&o.parseDay(e,a),"WEEKLY"==e.repeat&&(e.month[0]+e.year[0]==e.month[1]+e.year[1]?e.month[0]==o.month+1&&e.day[1]>=a&&a>=e.day[0]&&o.parseDay(e,a):(e.month[0]==o.month+1&&a>=e.day[0]||e.year[0]==e.year[1]&&e.month[1]>o.month+1&&e.month[0]<o.month+1||e.year[0]==e.year[1]&&e.month[1]==o.month+1&&a<=e.day[1]||e.year[0]!=e.year[1]&&e.month[0]<o.month+1)&&o.parseDay(e,a))):e.year[0]<o.year&&o.year<e.year[1]?"MONTHLY"!=e.repeat&&"WEEKLY"!=e.repeat||o.parseDay(e,a):o.month+1<=e.month[1]&&o.year==e.year[1]&&("MONTHLY"==e.repeat&&o.parseDay(e,a),("WEEKLY"==e.repeat&&a<=e.day[1]&&o.month+1==e.month[1]||"WEEKLY"==e.repeat&&e.year[0]!=e.year[1]&&o.month+1<e.month[1])&&o.parseDay(e,a))):o.year==e.year[0]&&o.month+1==e.month[0]&&o.parseDay(e,a))})),this.curData[a]?'<div class="fc-calendar-event">'+this.curData[a].html.join('</div><div class="fc-calendar-event">')+"</div>":""},e.prototype.parseID=function(e,a){var o=this;return t.each(e,(function(t,e){e&&o.parseDayID(e,a)})),this.curData[a]?this.curData[a].color:""},e.prototype.generateTemplate=function(e){this.curData=[];var a=this.getHead(),o=this.getBody(),n="";return 4==this.rowTotal?n="fc-four-rows":5==this.rowTotal?n="fc-five-rows":6==this.rowTotal&&(n="fc-six-rows"),this.$cal=t('<div class="fc-calendar '+n+'">').append(a,o),this.$element.find("div.fc-calendar").remove().end().append(this.$cal),this.propDate(),this.$element.trigger(t.Event("shown.calendar.calendario")),e&&e.call(),!0},e.prototype.getHead=function(){for(var t,e,a='<div class="fc-head row no-gutters align-items-center text-center font-weight-bold">',o=0;o<=6;o++)e=(t=o+this.options.startIn)>6?t-6-1:t,a+='<div class="col">'+(this.options.displayWeekAbbr?this.options.weekabbrs[e]:this.options.weeks[e])+"</div>";return a+"</div>"},e.prototype.getBody=function(){for(var t=new Date(this.year,this.month+1,0),e=t.getDate(),a=new Date(this.year,t.getMonth(),1),o=new Date(this.year,this.month,0).getDate(),n='<div class="fc-body"><div class="fc-row row no-gutters align-items-center text-center">',r=1,i=a.getDay(),s=0,h=0,p="",c=!1,l=!1,y="",d=0,u="",m="",f="",D=0;D<7;D++){for(var v=0;v<=6;v++){if(h=(s=i-this.options.startIn)<0?6+s+1:s,p="",c=this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&r===this.today.getDate(),l=this.year<this.today.getFullYear()||this.month<this.today.getMonth()&&this.year===this.today.getFullYear()||this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&r<this.today.getDate(),y="",d=v+this.options.startIn>6?v+this.options.startIn-6-1:v+this.options.startIn,this.options.fillEmpty&&(v<h||D>0)&&(r>e?p='<span class="fc-emptydate text-gray-400">'+(r++-e)+'</span><span class="fc-weekday d-none">':1==r&&(p='<span class="fc-emptydate text-gray-400">'+(o++-h+1)+'</span><span class="fc-weekday d-none">'),p+=this.options.weekabbrs[d]+"</span>"),f="",r<=e&&(D>0||v>=h)){if((u=Array.prototype.concat(this.caldata[r],this.caldata[this.options.weekabbrs[d].toUpperCase()]).sort((function(t,e){return(t.allDay?"00:00":t.startTime).replace(":","")-(e.allDay?"00:00":e.startTime).replace(":","")})))&&(y+=this.parseDataToDay(u,r)),y)var g=(f=this.parseID(u,r))[0].split("|");p='<span id="day-'+r+'" class="fc-date btn-block '+(""!==f?"btn-"+g[1]+" font-weight-bold text-white":"")+' text-decoration-none">'+r+'</span><span class="fc-weekday d-none">'+this.options.weekabbrs[d]+"</span>",""!==y&&(p+='<div class="fc-calendar-events">'+y+"</div>"),++r}else c=!1;n+=(""!==(m=(c?"fc-today ":"")+(l?"fc-past col border":"fc-future col border"))?'<div class="'+m.trim()+'">':"<div>")+p+"</div>"}if(r>e){this.rowTotal=D+1;break}n+='</div><div class="fc-row row no-gutters align-items-center text-center">'}return n+"</div></div>"},e.prototype.move=function(t,e,a){return"previous"===e?"month"===t?(this.year=this.month>0?this.year:--this.year,this.month=this.month>0?--this.month:11):"year"===t&&(this.year=--this.year):"next"===e&&("month"===t?(this.year=this.month<11?this.year:++this.year,this.month=this.month<11?++this.month:0):"year"===t&&(this.year=++this.year)),this.generateTemplate(a)},e.prototype.option=function(t,e){return e?this.options[t]=e:this.options[t]},e.prototype.getYear=function(){return this.year},e.prototype.getMonth=function(){return this.month+1},e.prototype.getMonthName=function(){return this.options.displayMonthAbbr?this.options.monthabbrs[this.month]:this.options.months[this.month]},e.prototype.getCell=function(e,a){return a?this.$cal.find("span.fc-date").filter((function(){return t(this).text()==e})).parent().data("bz.calendario.dateprop"):this.$cal.find("span.fc-date").filter((function(){return t(this).text()==e})).parent()},e.prototype.setData=function(e,a){return a?this.caldata=this.processCaldata(e):t.extend(this.caldata,this.processCaldata(e)),this.generateTemplate()},e.prototype.gotoNow=function(t){return this.month=this.today.getMonth(),this.year=this.today.getFullYear(),this.generateTemplate(t)},e.prototype.gotoMonth=function(t,e,a){return this.month=t-1,this.year=e,this.generateTemplate(a)},e.prototype.gotoPreviousMonth=function(t){return this.move("month","previous",t)},e.prototype.gotoPreviousYear=function(t){return this.move("year","previous",t)},e.prototype.gotoNextMonth=function(t){return this.move("month","next",t)},e.prototype.gotoNextYear=function(t){return this.move("year","next",t)},e.prototype.feed=function(){return this.syncData.feed?this.syncData.feed:"not-available"},e.prototype.version=function(){return this.INFO.VERSION};var a=t.fn.calendario;t.fn.calendario=function(a,o,n,r){var i="";if(this.each((function(){var s=t(this),h=s.data("bz.calendario"),p="object"==typeof a&&a;return h||s.data("bz.calendario",h=new e(this,p)),"string"==typeof a&&"function"==typeof h[a]?i=h[a](o,n,r):"string"==typeof a?i=h.option(o,n):void 0})),i)return i;t(document).trigger(t.Event("finish.calendar.calendario"))},t.fn.calendario.Constructor=e,t.fn.calendario.noConflict=function(){return t.fn.calendario=a,this}}(jQuery);