var picks=[];function details_in_popup(a,i,t){return $.ajax({url:"/includes/player_popover.php?p="+a,success:function(a){$("#"+i).html(a),t.popover("update"),$(".lazy").lazy({effect:"fadeIn",afterLoad:function(a){a.removeClass("lazy")}})}}),'<div id="'+i+'">'+LANG_USERPROFILE_LOADING+"</div>"}$("body").on("focus",".pick-player",(function(){var pick=$(this).data("pick"),icon=$(this).parent("div").next().find(".pick-icon"),numgk=eval($("#numgk").html()),numd=eval($("#numd").html()),numf=eval($("#numf").html());$(this).autocomplete({source:"/includes/draft_autocomplete.php?g="+numgk+"&d="+numd+"&f="+numf,minLength:3,select:function(a,i){var t=i.item.label.replace(/<(?:.|\n)*?>/gm,"");t=t.substring(1),$(this).val(t);var e=i.item.value.split("-");for(let a=1;a<11;++a){if((l=(s=$("#pick-"+a).val()).split("-"))[2]==e[2]){$(this).addClass("is-invalid");var n=(new Date).toLocaleDateString("sk-SK");return Notification("users text-danger",LANG_ERROR,n,LANG_FANTASY_ALREADYPICKED,5e3),!1}}$("#pick-"+pick).val(e[0]+"-"+e[1]+"-"+e[2]),picks=[];for(let a=1;a<11;++a){var s;if(""!=(s=$("#pick-"+a).val())){var l;if("GK"==(l=s.split("-"))[0])var c=1;else c=0;picks.push({pid:l[2],round:a,gk:c})}}$("#picks").val(JSON.stringify(picks));var p=$("#picks").val();return $.ajax({type:"POST",url:"/includes/fantasy_functions.php?save=1&json="+p,dataType:"text",contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:!1}),icon.html('<a href="#" class="btn btn-danger btn-sm remove-pick" data-pick="'+pick+'"><i class="fas fa-times-circle"></i></a>'),$(this).removeClass("is-invalid").addClass("is-valid"),$(this).prop("readonly",!0),10==$(".pick-player.is-valid").length?$("#draft-status").removeClass("bg-danger").addClass("bg-success").html(LANG_FANTASY_PICKSACTIVE):$("#draft-status").removeClass("bg-success").addClass("bg-danger").html(LANG_FANTASY_PICKSINACTIVE),"GK"==e[0]&&(numgk--,$("#numgk").html(numgk)),"D"==e[0]&&(numd--,$("#numd").html(numd)),"F"==e[0]&&(numf--,$("#numf").html(numf)),!1}}).autocomplete("instance")._renderItem=function(a,i){return $("<li>").append("<div>"+i.label+"</div>").appendTo(a)}})),$("body").on("click",".remove-pick",(function(){var pick=$(this).data("pick");$(this).remove();var data=$("#pick-"+pick).val().split("-"),pos=data[0];if("GK"==pos){var numgk=eval($("#numgk").html());numgk++,$("#numgk").html(numgk)}if("D"==pos){var numd=eval($("#numd").html());numd++,$("#numd").html(numd)}if("F"==pos){var numf=eval($("#numf").html());numf++,$("#numf").html(numf)}$("#pick-"+pick).val(""),picks=[];for(let a=1;a<11;++a){var pickdata=$("#pick-"+a).val();if(""!=pickdata){var data=pickdata.split("-");if("GK"==data[0])var gk=1;else var gk=0;picks.push({pid:data[2],round:a,gk:gk})}}$("#picks").val(JSON.stringify(picks));var json=$("#picks").val();$.ajax({type:"POST",url:"/includes/fantasy_functions.php?save=1&json="+json,dataType:"text",contentType:"application/x-www-form-urlencoded; charset=utf-8",cache:!1}),$('input[data-pick="'+pick+'"]').prop("readonly",!1).val("").removeClass("is-valid").focus(),10==$(".pick-player.is-valid").length?$("#draft-status").removeClass("bg-danger").addClass("bg-success").html(LANG_FANTASY_PICKSACTIVE):$("#draft-status").removeClass("bg-success").addClass("bg-danger").html(LANG_FANTASY_PICKSINACTIVE)})),$("body").on("click",".change-player",(function(){var a=$(this).data("pid"),i=$(this);$.ajax({url:"/includes/dialog.php?action=change&pid="+a,success:function(a){i.tooltip("hide"),$("#dialog").html(a),$("#dialog").modal("show")}})})),$("body").on("click",".change",(function(){var a=$("#newpid").val(),i=$("#oldpid").val();$.ajax({url:"/includes/dialog.php?action=change&newpid="+a+"&oldpid="+i,success:function(a){$("#dialog").modal("hide"),location.href="/fantasy/picks"}})})),$(document).ready((function(){$('[data-toggle="popover"]').popover({placement:"top",trigger:"hover",delay:{show:500,hide:100},html:!0,content:function(){var a="tmp-id-"+$.now();return details_in_popup($(this).data("player"),a,$(this))}})}));